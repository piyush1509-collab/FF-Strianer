<!DOCTYPE html>
<html>
<head>
  <title>Gantt Chart Viewer</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      background-color: #121212;
      color: white;
      padding: 20px;
    }
    #chart {
      width: 100%;
      height: 600px;
      background-color: #1A1A1A;
      border: 1px solid #444;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h2>Gantt Chart Visualization</h2>
  <div id="chart">Loading...</div>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbx0ONP7n--dNO1ygXdfBUS_m83iqDujWxsaexbPO6qPW41lWK34TG0HK7ARwUgiUV1i/exec';

    fetch(API_URL)
      .then(res => res.json())
      .then(data => {
        const traces = data.map(item => ({
          x: [item.startDate, item.endDate],
          y: [item.equipment, item.equipment],
          mode: 'lines',
          line: {
            width: 20,
            color: item.color || '#00ADB5'
          },
          name: `${item.equipment} (${item.vendor})`,
          hoverinfo: 'text',
          text: `Vendor: ${item.vendor}<br>Start: ${item.startDate}<br>End: ${item.endDate}`
        }));

        Plotly.newPlot('chart', traces, {
          title: 'Equipment Replacement Gantt Chart',
          yaxis: {
            type: 'category'
          },
          plot_bgcolor: '#121212',
          paper_bgcolor: '#121212',
          font: { color: 'white' }
        });
      });
  </script>
</body>
</html>

